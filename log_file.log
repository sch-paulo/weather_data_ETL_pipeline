2025-02-02T17:25:54.699282-0400 INFO Chamando função 'run_pipeline' com args () e kwargs {} utils_log.py
2025-02-02T17:25:54.699526-0400 INFO Chamando função 'init_database' com args () e kwargs {} utils_log.py
2025-02-02T17:25:54.699685-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-02T17:25:57.376608-0400 ERROR Exceção capturada em 'database_connection': could not translate host name "postgres" to address: Name or service not known
 utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 35, in <module>
    run_pipeline()
    └ <function run_pipeline at 0x000001EEA6CE8D60>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function run_pipeline at 0x000001EEA6CE39C0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 20, in run_pipeline
    init_database()
    └ <function init_database at 0x000001EEA9E8BD80>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function init_database at 0x000001EEA9E8BCE0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 88, in init_database
    conn = database_connection()
           └ <function database_connection at 0x000001EEA9E8BC40>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001EEA9E8BBA0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 77, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001EEA9405440>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weather_pass dbname=weather_db'
           └ <built-in function _connect>

psycopg2.OperationalError: could not translate host name "postgres" to address: Name or service not known

2025-02-02T17:25:57.379657-0400 INFO Função 'init_database' retornou None utils_log.py
2025-02-02T17:25:57.379826-0400 INFO Chamando função 'extract_city_weather_data' com args ('Manaus', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-02T17:25:57.842894-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -60.025, 'lat': -3.1019}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 301.42, 'feels_like': 304.2, 'temp_min': 301.42, 'temp_max': 301.43, 'pressure': 1006, 'humidity': 69, 'sea_level': 1006, 'grnd_level': 1002}, 'visibility': 10000, 'wind': {'speed': 1.54, 'deg': 40}, 'clouds': {'all': 75}, 'dt': 1738531373, 'sys': {'type': 1, 'id': 8412, 'country': 'BR', 'sunrise': 1738490796, 'sunset': 1738534860}, 'timezone': -14400, 'id': 3663517, 'name': 'Manaus', 'cod': 200} utils_log.py
2025-02-02T17:25:57.843308-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -60.025, 'lat': -3.1019}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 301.42, 'feels_like': 304.2, 'temp_min': 301.42, 'temp_max': 301.43, 'pressure': 1006, 'humidity': 69, 'sea_level': 1006, 'grnd_level': 1002}, 'visibility': 10000, 'wind': {'speed': 1.54, 'deg': 40}, 'clouds': {'all': 75}, 'dt': 1738531373, 'sys': {'type': 1, 'id': 8412, 'country': 'BR', 'sunrise': 1738490796, 'sunset': 1738534860}, 'timezone': -14400, 'id': 3663517, 'name': 'Manaus', 'cod': 200},) e kwargs {} utils_log.py
2025-02-02T17:25:57.843612-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-02 17:22:53', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind_speed': 1.54, 'description': 'broken clouds', 'longitude': -60.025, 'latitude': -3.1019} utils_log.py
2025-02-02T17:25:57.843795-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-02 17:22:53', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind_speed': 1.54, 'description': 'broken clouds', 'longitude': -60.025, 'latitude': -3.1019},) e kwargs {} utils_log.py
2025-02-02T17:25:57.843940-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-02T17:26:00.536537-0400 ERROR Exceção capturada em 'database_connection': could not translate host name "postgres" to address: Name or service not known
 utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 35, in <module>
    run_pipeline()
    └ <function run_pipeline at 0x000001EEA6CE8D60>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function run_pipeline at 0x000001EEA6CE39C0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 29, in run_pipeline
    load_weather_data_on_database(weather_data)
    │                             └ {'timestamp': '2025-02-02 17:22:53', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind_...
    └ <function load_weather_data_on_database at 0x000001EEA9E8BEC0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-02 17:22:53', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind...
             └ <function load_weather_data_on_database at 0x000001EEA9E8BE20>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 119, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001EEA9E8BC40>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001EEA9E8BBA0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 77, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001EEA9405440>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weather_pass dbname=weather_db'
           └ <built-in function _connect>

psycopg2.OperationalError: could not translate host name "postgres" to address: Name or service not known

2025-02-02T17:26:00.538693-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-02T17:26:00.538872-0400 INFO Função 'run_pipeline' retornou None utils_log.py
2025-02-02T17:27:33.745834-0400 INFO Chamando função 'run_pipeline' com args () e kwargs {} utils_log.py
2025-02-02T17:27:33.746271-0400 INFO Chamando função 'init_database' com args () e kwargs {} utils_log.py
2025-02-02T17:27:33.746525-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-02T17:27:36.427744-0400 ERROR Exceção capturada em 'database_connection': could not translate host name "postgres" to address: Name or service not known
 utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 35, in <module>
    run_pipeline()
    └ <function run_pipeline at 0x000001320E7F8D60>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function run_pipeline at 0x000001320E7F39C0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 20, in run_pipeline
    init_database()
    └ <function init_database at 0x00000132119DBE20>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function init_database at 0x00000132119DBD80>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 88, in init_database
    conn = database_connection()
           └ <function database_connection at 0x00000132119DBCE0>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x00000132119DBC40>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 77, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x0000013210F194E0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weather_pass dbname=weather_db'
           └ <built-in function _connect>

psycopg2.OperationalError: could not translate host name "postgres" to address: Name or service not known

2025-02-02T17:27:36.430632-0400 INFO Função 'init_database' retornou None utils_log.py
2025-02-02T17:27:36.430912-0400 INFO Chamando função 'extract_city_weather_data' com args ('Manaus', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-02T17:27:36.891454-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -60.025, 'lat': -3.1019}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 301.42, 'feels_like': 304.2, 'temp_min': 301.42, 'temp_max': 301.43, 'pressure': 1006, 'humidity': 69, 'sea_level': 1006, 'grnd_level': 1002}, 'visibility': 10000, 'wind': {'speed': 1.54, 'deg': 40}, 'clouds': {'all': 75}, 'dt': 1738531490, 'sys': {'type': 1, 'id': 8412, 'country': 'BR', 'sunrise': 1738490796, 'sunset': 1738534860}, 'timezone': -14400, 'id': 3663517, 'name': 'Manaus', 'cod': 200} utils_log.py
2025-02-02T17:27:36.892085-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -60.025, 'lat': -3.1019}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 301.42, 'feels_like': 304.2, 'temp_min': 301.42, 'temp_max': 301.43, 'pressure': 1006, 'humidity': 69, 'sea_level': 1006, 'grnd_level': 1002}, 'visibility': 10000, 'wind': {'speed': 1.54, 'deg': 40}, 'clouds': {'all': 75}, 'dt': 1738531490, 'sys': {'type': 1, 'id': 8412, 'country': 'BR', 'sunrise': 1738490796, 'sunset': 1738534860}, 'timezone': -14400, 'id': 3663517, 'name': 'Manaus', 'cod': 200},) e kwargs {} utils_log.py
2025-02-02T17:27:36.892334-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-02 17:24:50', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind_speed': 1.54, 'description': 'broken clouds', 'longitude': -60.025, 'latitude': -3.1019} utils_log.py
2025-02-02T17:27:36.892512-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-02 17:24:50', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind_speed': 1.54, 'description': 'broken clouds', 'longitude': -60.025, 'latitude': -3.1019},) e kwargs {} utils_log.py
2025-02-02T17:27:36.892661-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-02T17:27:39.578145-0400 ERROR Exceção capturada em 'database_connection': could not translate host name "postgres" to address: Name or service not known
 utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 35, in <module>
    run_pipeline()
    └ <function run_pipeline at 0x000001320E7F8D60>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function run_pipeline at 0x000001320E7F39C0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\main.py", line 29, in run_pipeline
    load_weather_data_on_database(weather_data)
    │                             └ {'timestamp': '2025-02-02 17:24:50', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind_...
    └ <function load_weather_data_on_database at 0x00000132119DBF60>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-02 17:24:50', 'city': 'Manaus', 'temperature': 28.27, 'feels_like_temp': 31.05, 'humidity': 69, 'wind...
             └ <function load_weather_data_on_database at 0x00000132119DBEC0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 119, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x00000132119DBCE0>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x00000132119DBC40>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 77, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x0000013210F194E0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weather_pass dbname=weather_db'
           └ <built-in function _connect>

psycopg2.OperationalError: could not translate host name "postgres" to address: Name or service not known

2025-02-02T17:27:39.580354-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-02T17:27:39.580511-0400 INFO Função 'run_pipeline' retornou None utils_log.py
2025-02-04T18:11:44.421095-0400 INFO Chamando função 'init_database' com args () e kwargs {} utils_log.py
2025-02-04T18:11:44.422100-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-04T18:11:47.107815-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 141, in <module>
    init_database()
    └ <function init_database at 0x0000027B2FD2E340>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function init_database at 0x0000027B2FD2E2A0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 87, in init_database
    conn = database_connection()
           └ <function database_connection at 0x0000027B2FD2E200>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x0000027B2FD2E160>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x0000027B2F9CFD80>
           └ <module 'psycopg2' from 'C:\\users\\pschm\\onedrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\users\pschm\onedrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weather_pass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-04T18:11:47.110813-0400 INFO Função 'init_database' retornou None utils_log.py
2025-02-07T18:03:10.103805-0400 INFO Chamando função 'init_database' com args () e kwargs {} utils_log.py
2025-02-07T18:03:10.104804-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:12.819392-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 147, in <module>
    init_database()
    └ <function init_database at 0x000001DFF15282C0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function init_database at 0x000001DFF1528220>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 87, in init_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:12.831138-0400 INFO Função 'init_database' retornou None utils_log.py
2025-02-07T18:03:12.831138-0400 INFO Chamando função 'extract_city_weather_data' com args ('Aracaju', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:13.283742-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -37.0717, 'lat': -10.9111}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 301.12, 'feels_like': 304.3, 'temp_min': 301.12, 'temp_max': 301.12, 'pressure': 1011, 'humidity': 74, 'sea_level': 1011, 'grnd_level': 1009}, 'visibility': 10000, 'wind': {'speed': 4.63, 'deg': 150}, 'clouds': {'all': 40}, 'dt': 1738965714, 'sys': {'type': 1, 'id': 8322, 'country': 'BR', 'sunrise': 1738916816, 'sunset': 1738961880}, 'timezone': -10800, 'id': 3471872, 'name': 'Aracaju', 'cod': 200} utils_log.py
2025-02-07T18:03:13.284743-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -37.0717, 'lat': -10.9111}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 301.12, 'feels_like': 304.3, 'temp_min': 301.12, 'temp_max': 301.12, 'pressure': 1011, 'humidity': 74, 'sea_level': 1011, 'grnd_level': 1009}, 'visibility': 10000, 'wind': {'speed': 4.63, 'deg': 150}, 'clouds': {'all': 40}, 'dt': 1738965714, 'sys': {'type': 1, 'id': 8322, 'country': 'BR', 'sunrise': 1738916816, 'sunset': 1738961880}, 'timezone': -10800, 'id': 3471872, 'name': 'Aracaju', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:13.284743-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:01:54', 'city': 'Aracaju', 'temperature': 27.97, 'feels_like_temp': 31.15, 'humidity': 74, 'wind_speed': 4.63, 'description': 'scattered clouds', 'longitude': -37.0717, 'latitude': -10.9111} utils_log.py
2025-02-07T18:03:13.284743-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:01:54', 'city': 'Aracaju', 'temperature': 27.97, 'feels_like_temp': 31.15, 'humidity': 74, 'wind_speed': 4.63, 'description': 'scattered clouds', 'longitude': -37.0717, 'latitude': -10.9111},) e kwargs {} utils_log.py
2025-02-07T18:03:13.284743-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:15.977569-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:01:54', 'city': 'Aracaju', 'temperature': 27.97, 'feels_like_temp': 31.15, 'humidity': 74, 'wind...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:01:54', 'city': 'Aracaju', 'temperature': 27.97, 'feels_like_temp': 31.15, 'humidity': 74, 'win...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:15.979186-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:15.979186-0400 INFO Chamando função 'extract_city_weather_data' com args ('Belém', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:16.409516-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -48.5044, 'lat': -1.4558}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 298.17, 'feels_like': 299.18, 'temp_min': 298.17, 'temp_max': 298.17, 'pressure': 1008, 'humidity': 94, 'sea_level': 1008, 'grnd_level': 1007}, 'visibility': 3000, 'wind': {'speed': 5.66, 'deg': 60}, 'clouds': {'all': 75}, 'dt': 1738965608, 'sys': {'type': 1, 'id': 8321, 'country': 'BR', 'sunrise': 1738920190, 'sunset': 1738963993}, 'timezone': -10800, 'id': 3405870, 'name': 'Belém', 'cod': 200} utils_log.py
2025-02-07T18:03:16.409516-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -48.5044, 'lat': -1.4558}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 298.17, 'feels_like': 299.18, 'temp_min': 298.17, 'temp_max': 298.17, 'pressure': 1008, 'humidity': 94, 'sea_level': 1008, 'grnd_level': 1007}, 'visibility': 3000, 'wind': {'speed': 5.66, 'deg': 60}, 'clouds': {'all': 75}, 'dt': 1738965608, 'sys': {'type': 1, 'id': 8321, 'country': 'BR', 'sunrise': 1738920190, 'sunset': 1738963993}, 'timezone': -10800, 'id': 3405870, 'name': 'Belém', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:16.410516-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:00:08', 'city': 'Belém', 'temperature': 25.02, 'feels_like_temp': 26.03, 'humidity': 94, 'wind_speed': 5.66, 'description': 'broken clouds', 'longitude': -48.5044, 'latitude': -1.4558} utils_log.py
2025-02-07T18:03:16.410516-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:00:08', 'city': 'Belém', 'temperature': 25.02, 'feels_like_temp': 26.03, 'humidity': 94, 'wind_speed': 5.66, 'description': 'broken clouds', 'longitude': -48.5044, 'latitude': -1.4558},) e kwargs {} utils_log.py
2025-02-07T18:03:16.410516-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:19.117479-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:00:08', 'city': 'Belém', 'temperature': 25.02, 'feels_like_temp': 26.03, 'humidity': 94, 'wind_s...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:00:08', 'city': 'Belém', 'temperature': 25.02, 'feels_like_temp': 26.03, 'humidity': 94, 'wind_...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:19.119479-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:19.119479-0400 INFO Chamando função 'extract_city_weather_data' com args ('Belo Horizonte', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:19.553658-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -43.9378, 'lat': -19.9208}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10n'}], 'base': 'stations', 'main': {'temp': 301.59, 'feels_like': 301.63, 'temp_min': 301.59, 'temp_max': 301.59, 'pressure': 1014, 'humidity': 45, 'sea_level': 1014, 'grnd_level': 905}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 100}, 'rain': {'1h': 0.17}, 'clouds': {'all': 0}, 'dt': 1738965698, 'sys': {'type': 1, 'id': 8329, 'country': 'BR', 'sunrise': 1738917818, 'sunset': 1738964174}, 'timezone': -10800, 'id': 3470127, 'name': 'Belo Horizonte', 'cod': 200} utils_log.py
2025-02-07T18:03:19.553658-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -43.9378, 'lat': -19.9208}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10n'}], 'base': 'stations', 'main': {'temp': 301.59, 'feels_like': 301.63, 'temp_min': 301.59, 'temp_max': 301.59, 'pressure': 1014, 'humidity': 45, 'sea_level': 1014, 'grnd_level': 905}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 100}, 'rain': {'1h': 0.17}, 'clouds': {'all': 0}, 'dt': 1738965698, 'sys': {'type': 1, 'id': 8329, 'country': 'BR', 'sunrise': 1738917818, 'sunset': 1738964174}, 'timezone': -10800, 'id': 3470127, 'name': 'Belo Horizonte', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:19.553658-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:01:38', 'city': 'Belo Horizonte', 'temperature': 28.44, 'feels_like_temp': 28.48, 'humidity': 45, 'wind_speed': 4.12, 'description': 'light rain', 'longitude': -43.9378, 'latitude': -19.9208} utils_log.py
2025-02-07T18:03:19.553658-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:01:38', 'city': 'Belo Horizonte', 'temperature': 28.44, 'feels_like_temp': 28.48, 'humidity': 45, 'wind_speed': 4.12, 'description': 'light rain', 'longitude': -43.9378, 'latitude': -19.9208},) e kwargs {} utils_log.py
2025-02-07T18:03:19.553658-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:22.254455-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:01:38', 'city': 'Belo Horizonte', 'temperature': 28.44, 'feels_like_temp': 28.48, 'humidity': 45...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:01:38', 'city': 'Belo Horizonte', 'temperature': 28.44, 'feels_like_temp': 28.48, 'humidity': 4...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:22.256460-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:22.256460-0400 INFO Chamando função 'extract_city_weather_data' com args ('Boa Vista', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:22.701993-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -60.6733, 'lat': 2.8197}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'base': 'stations', 'main': {'temp': 303.14, 'feels_like': 305.57, 'temp_min': 303.14, 'temp_max': 303.14, 'pressure': 1007, 'humidity': 58, 'sea_level': 1007, 'grnd_level': 998}, 'visibility': 10000, 'wind': {'speed': 3.09, 'deg': 160}, 'clouds': {'all': 40}, 'dt': 1738965608, 'sys': {'type': 1, 'id': 8340, 'country': 'BR', 'sunrise': 1738923390, 'sunset': 1738966635}, 'timezone': -14400, 'id': 3664980, 'name': 'Boa Vista', 'cod': 200} utils_log.py
2025-02-07T18:03:22.701993-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -60.6733, 'lat': 2.8197}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'base': 'stations', 'main': {'temp': 303.14, 'feels_like': 305.57, 'temp_min': 303.14, 'temp_max': 303.14, 'pressure': 1007, 'humidity': 58, 'sea_level': 1007, 'grnd_level': 998}, 'visibility': 10000, 'wind': {'speed': 3.09, 'deg': 160}, 'clouds': {'all': 40}, 'dt': 1738965608, 'sys': {'type': 1, 'id': 8340, 'country': 'BR', 'sunrise': 1738923390, 'sunset': 1738966635}, 'timezone': -14400, 'id': 3664980, 'name': 'Boa Vista', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:22.703003-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:00:08', 'city': 'Boa Vista', 'temperature': 29.99, 'feels_like_temp': 32.42, 'humidity': 58, 'wind_speed': 3.09, 'description': 'scattered clouds', 'longitude': -60.6733, 'latitude': 2.8197} utils_log.py
2025-02-07T18:03:22.703003-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:00:08', 'city': 'Boa Vista', 'temperature': 29.99, 'feels_like_temp': 32.42, 'humidity': 58, 'wind_speed': 3.09, 'description': 'scattered clouds', 'longitude': -60.6733, 'latitude': 2.8197},) e kwargs {} utils_log.py
2025-02-07T18:03:22.703003-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:25.400205-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:00:08', 'city': 'Boa Vista', 'temperature': 29.99, 'feels_like_temp': 32.42, 'humidity': 58, 'wi...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:00:08', 'city': 'Boa Vista', 'temperature': 29.99, 'feels_like_temp': 32.42, 'humidity': 58, 'w...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:25.402205-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:25.402205-0400 INFO Chamando função 'extract_city_weather_data' com args ('Brasília', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:25.837330-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -47.9297, 'lat': -15.7797}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 298.66, 'feels_like': 298.57, 'temp_min': 296.83, 'temp_max': 298.66, 'pressure': 1013, 'humidity': 50, 'sea_level': 1013, 'grnd_level': 888}, 'visibility': 10000, 'wind': {'speed': 4.63, 'deg': 140}, 'clouds': {'all': 20}, 'dt': 1738965806, 'sys': {'type': 1, 'id': 8336, 'country': 'BR', 'sunrise': 1738919081, 'sunset': 1738964827}, 'timezone': -10800, 'id': 3469058, 'name': 'Brasília', 'cod': 200} utils_log.py
2025-02-07T18:03:25.837330-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -47.9297, 'lat': -15.7797}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 298.66, 'feels_like': 298.57, 'temp_min': 296.83, 'temp_max': 298.66, 'pressure': 1013, 'humidity': 50, 'sea_level': 1013, 'grnd_level': 888}, 'visibility': 10000, 'wind': {'speed': 4.63, 'deg': 140}, 'clouds': {'all': 20}, 'dt': 1738965806, 'sys': {'type': 1, 'id': 8336, 'country': 'BR', 'sunrise': 1738919081, 'sunset': 1738964827}, 'timezone': -10800, 'id': 3469058, 'name': 'Brasília', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:25.837330-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:03:26', 'city': 'Brasília', 'temperature': 25.51, 'feels_like_temp': 25.42, 'humidity': 50, 'wind_speed': 4.63, 'description': 'few clouds', 'longitude': -47.9297, 'latitude': -15.7797} utils_log.py
2025-02-07T18:03:25.837330-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:03:26', 'city': 'Brasília', 'temperature': 25.51, 'feels_like_temp': 25.42, 'humidity': 50, 'wind_speed': 4.63, 'description': 'few clouds', 'longitude': -47.9297, 'latitude': -15.7797},) e kwargs {} utils_log.py
2025-02-07T18:03:25.838527-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:28.529295-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:03:26', 'city': 'Brasília', 'temperature': 25.51, 'feels_like_temp': 25.42, 'humidity': 50, 'win...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:03:26', 'city': 'Brasília', 'temperature': 25.51, 'feels_like_temp': 25.42, 'humidity': 50, 'wi...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:28.531295-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:28.531295-0400 INFO Chamando função 'extract_city_weather_data' com args ('Campo Grande', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:28.962833-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -54.6464, 'lat': -20.4428}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 297.9, 'feels_like': 298.6, 'temp_min': 297.9, 'temp_max': 297.9, 'pressure': 1013, 'humidity': 83, 'sea_level': 1013, 'grnd_level': 950}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 50}, 'clouds': {'all': 75}, 'dt': 1738965602, 'sys': {'type': 1, 'id': 8347, 'country': 'BR', 'sunrise': 1738920349, 'sunset': 1738966783}, 'timezone': -14400, 'id': 3467747, 'name': 'Campo Grande', 'cod': 200} utils_log.py
2025-02-07T18:03:28.963833-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -54.6464, 'lat': -20.4428}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 297.9, 'feels_like': 298.6, 'temp_min': 297.9, 'temp_max': 297.9, 'pressure': 1013, 'humidity': 83, 'sea_level': 1013, 'grnd_level': 950}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 50}, 'clouds': {'all': 75}, 'dt': 1738965602, 'sys': {'type': 1, 'id': 8347, 'country': 'BR', 'sunrise': 1738920349, 'sunset': 1738966783}, 'timezone': -14400, 'id': 3467747, 'name': 'Campo Grande', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:28.963833-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:00:02', 'city': 'Campo Grande', 'temperature': 24.75, 'feels_like_temp': 25.45, 'humidity': 83, 'wind_speed': 4.12, 'description': 'broken clouds', 'longitude': -54.6464, 'latitude': -20.4428} utils_log.py
2025-02-07T18:03:28.963833-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:00:02', 'city': 'Campo Grande', 'temperature': 24.75, 'feels_like_temp': 25.45, 'humidity': 83, 'wind_speed': 4.12, 'description': 'broken clouds', 'longitude': -54.6464, 'latitude': -20.4428},) e kwargs {} utils_log.py
2025-02-07T18:03:28.963833-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:31.684930-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:00:02', 'city': 'Campo Grande', 'temperature': 24.75, 'feels_like_temp': 25.45, 'humidity': 83, ...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:00:02', 'city': 'Campo Grande', 'temperature': 24.75, 'feels_like_temp': 25.45, 'humidity': 83,...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:31.685931-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:31.686932-0400 INFO Chamando função 'extract_city_weather_data' com args ('Cuiabá', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:32.116241-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -56.0967, 'lat': -15.5961}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02d'}], 'base': 'stations', 'main': {'temp': 301.11, 'feels_like': 304.28, 'temp_min': 301.11, 'temp_max': 301.11, 'pressure': 1007, 'humidity': 74, 'sea_level': 1007, 'grnd_level': 986}, 'visibility': 10000, 'wind': {'speed': 3.09, 'deg': 40}, 'clouds': {'all': 20}, 'dt': 1738965805, 'sys': {'type': 1, 'id': 8352, 'country': 'BR', 'sunrise': 1738921055, 'sunset': 1738966773}, 'timezone': -14400, 'id': 3465038, 'name': 'Cuiabá', 'cod': 200} utils_log.py
2025-02-07T18:03:32.117241-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -56.0967, 'lat': -15.5961}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02d'}], 'base': 'stations', 'main': {'temp': 301.11, 'feels_like': 304.28, 'temp_min': 301.11, 'temp_max': 301.11, 'pressure': 1007, 'humidity': 74, 'sea_level': 1007, 'grnd_level': 986}, 'visibility': 10000, 'wind': {'speed': 3.09, 'deg': 40}, 'clouds': {'all': 20}, 'dt': 1738965805, 'sys': {'type': 1, 'id': 8352, 'country': 'BR', 'sunrise': 1738921055, 'sunset': 1738966773}, 'timezone': -14400, 'id': 3465038, 'name': 'Cuiabá', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:32.117241-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:03:25', 'city': 'Cuiabá', 'temperature': 27.96, 'feels_like_temp': 31.13, 'humidity': 74, 'wind_speed': 3.09, 'description': 'few clouds', 'longitude': -56.0967, 'latitude': -15.5961} utils_log.py
2025-02-07T18:03:32.117241-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:03:25', 'city': 'Cuiabá', 'temperature': 27.96, 'feels_like_temp': 31.13, 'humidity': 74, 'wind_speed': 3.09, 'description': 'few clouds', 'longitude': -56.0967, 'latitude': -15.5961},) e kwargs {} utils_log.py
2025-02-07T18:03:32.117241-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:34.812215-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:03:25', 'city': 'Cuiabá', 'temperature': 27.96, 'feels_like_temp': 31.13, 'humidity': 74, 'wind_...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:03:25', 'city': 'Cuiabá', 'temperature': 27.96, 'feels_like_temp': 31.13, 'humidity': 74, 'wind...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:34.813276-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:34.814275-0400 INFO Chamando função 'extract_city_weather_data' com args ('Curitiba', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:35.247882-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -49.2908, 'lat': -25.504}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 293.17, 'feels_like': 293.68, 'temp_min': 292.69, 'temp_max': 293.25, 'pressure': 1016, 'humidity': 94, 'sea_level': 1016, 'grnd_level': 915}, 'visibility': 7000, 'wind': {'speed': 3.6, 'deg': 110}, 'clouds': {'all': 100}, 'dt': 1738965391, 'sys': {'type': 2, 'id': 2073418, 'country': 'BR', 'sunrise': 1738918662, 'sunset': 1738965900}, 'timezone': -10800, 'id': 6322752, 'name': 'Curitiba', 'cod': 200} utils_log.py
2025-02-07T18:03:35.247882-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -49.2908, 'lat': -25.504}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 293.17, 'feels_like': 293.68, 'temp_min': 292.69, 'temp_max': 293.25, 'pressure': 1016, 'humidity': 94, 'sea_level': 1016, 'grnd_level': 915}, 'visibility': 7000, 'wind': {'speed': 3.6, 'deg': 110}, 'clouds': {'all': 100}, 'dt': 1738965391, 'sys': {'type': 2, 'id': 2073418, 'country': 'BR', 'sunrise': 1738918662, 'sunset': 1738965900}, 'timezone': -10800, 'id': 6322752, 'name': 'Curitiba', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:35.247882-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 17:56:31', 'city': 'Curitiba', 'temperature': 20.02, 'feels_like_temp': 20.53, 'humidity': 94, 'wind_speed': 3.6, 'description': 'overcast clouds', 'longitude': -49.2908, 'latitude': -25.504} utils_log.py
2025-02-07T18:03:35.248882-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 17:56:31', 'city': 'Curitiba', 'temperature': 20.02, 'feels_like_temp': 20.53, 'humidity': 94, 'wind_speed': 3.6, 'description': 'overcast clouds', 'longitude': -49.2908, 'latitude': -25.504},) e kwargs {} utils_log.py
2025-02-07T18:03:35.248882-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:37.946206-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 17:56:31', 'city': 'Curitiba', 'temperature': 20.02, 'feels_like_temp': 20.53, 'humidity': 94, 'win...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 17:56:31', 'city': 'Curitiba', 'temperature': 20.02, 'feels_like_temp': 20.53, 'humidity': 94, 'wi...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:37.947804-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:37.948322-0400 INFO Chamando função 'extract_city_weather_data' com args ('Florianópolis', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:38.474146-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -48.5012, 'lat': -27.6146}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 295.72, 'feels_like': 296.33, 'temp_min': 295.72, 'temp_max': 296.72, 'pressure': 1016, 'humidity': 88, 'sea_level': 1016, 'grnd_level': 1011}, 'visibility': 10000, 'wind': {'speed': 5.66, 'deg': 200}, 'clouds': {'all': 100}, 'dt': 1738965482, 'sys': {'type': 1, 'id': 8360, 'country': 'BR', 'sunrise': 1738918294, 'sunset': 1738965889}, 'timezone': -10800, 'id': 6323121, 'name': 'Florianópolis', 'cod': 200} utils_log.py
2025-02-07T18:03:38.474146-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -48.5012, 'lat': -27.6146}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 295.72, 'feels_like': 296.33, 'temp_min': 295.72, 'temp_max': 296.72, 'pressure': 1016, 'humidity': 88, 'sea_level': 1016, 'grnd_level': 1011}, 'visibility': 10000, 'wind': {'speed': 5.66, 'deg': 200}, 'clouds': {'all': 100}, 'dt': 1738965482, 'sys': {'type': 1, 'id': 8360, 'country': 'BR', 'sunrise': 1738918294, 'sunset': 1738965889}, 'timezone': -10800, 'id': 6323121, 'name': 'Florianópolis', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:38.474146-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 17:58:02', 'city': 'Florianópolis', 'temperature': 22.57, 'feels_like_temp': 23.18, 'humidity': 88, 'wind_speed': 5.66, 'description': 'overcast clouds', 'longitude': -48.5012, 'latitude': -27.6146} utils_log.py
2025-02-07T18:03:38.475146-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 17:58:02', 'city': 'Florianópolis', 'temperature': 22.57, 'feels_like_temp': 23.18, 'humidity': 88, 'wind_speed': 5.66, 'description': 'overcast clouds', 'longitude': -48.5012, 'latitude': -27.6146},) e kwargs {} utils_log.py
2025-02-07T18:03:38.475146-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:41.180289-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 17:58:02', 'city': 'Florianópolis', 'temperature': 22.57, 'feels_like_temp': 23.18, 'humidity': 88,...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 17:58:02', 'city': 'Florianópolis', 'temperature': 22.57, 'feels_like_temp': 23.18, 'humidity': 88...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:41.181792-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:41.181792-0400 INFO Chamando função 'extract_city_weather_data' com args ('Fortaleza', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:41.829684-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -38.5247, 'lat': -3.7227}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01n'}], 'base': 'stations', 'main': {'temp': 301.22, 'feels_like': 305.11, 'temp_min': 301.22, 'temp_max': 301.6, 'pressure': 1009, 'humidity': 78, 'sea_level': 1009, 'grnd_level': 1007}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 90}, 'clouds': {'all': 0}, 'dt': 1738965581, 'sys': {'type': 1, 'id': 8363, 'country': 'BR', 'sunrise': 1738917646, 'sunset': 1738961747}, 'timezone': -10800, 'id': 6320062, 'name': 'Fortaleza', 'cod': 200} utils_log.py
2025-02-07T18:03:41.830211-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -38.5247, 'lat': -3.7227}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01n'}], 'base': 'stations', 'main': {'temp': 301.22, 'feels_like': 305.11, 'temp_min': 301.22, 'temp_max': 301.6, 'pressure': 1009, 'humidity': 78, 'sea_level': 1009, 'grnd_level': 1007}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 90}, 'clouds': {'all': 0}, 'dt': 1738965581, 'sys': {'type': 1, 'id': 8363, 'country': 'BR', 'sunrise': 1738917646, 'sunset': 1738961747}, 'timezone': -10800, 'id': 6320062, 'name': 'Fortaleza', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:41.830733-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 17:59:41', 'city': 'Fortaleza', 'temperature': 28.07, 'feels_like_temp': 31.96, 'humidity': 78, 'wind_speed': 2.57, 'description': 'clear sky', 'longitude': -38.5247, 'latitude': -3.7227} utils_log.py
2025-02-07T18:03:41.830733-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 17:59:41', 'city': 'Fortaleza', 'temperature': 28.07, 'feels_like_temp': 31.96, 'humidity': 78, 'wind_speed': 2.57, 'description': 'clear sky', 'longitude': -38.5247, 'latitude': -3.7227},) e kwargs {} utils_log.py
2025-02-07T18:03:41.830733-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:44.544057-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 17:59:41', 'city': 'Fortaleza', 'temperature': 28.07, 'feels_like_temp': 31.96, 'humidity': 78, 'wi...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 17:59:41', 'city': 'Fortaleza', 'temperature': 28.07, 'feels_like_temp': 31.96, 'humidity': 78, 'w...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:44.546058-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:44.546058-0400 INFO Chamando função 'extract_city_weather_data' com args ('Goiânia', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:44.977667-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -49.2539, 'lat': -16.6786}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 302.98, 'feels_like': 302.87, 'temp_min': 302.98, 'temp_max': 302.98, 'pressure': 1011, 'humidity': 42, 'sea_level': 1011, 'grnd_level': 924}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 140}, 'clouds': {'all': 20}, 'dt': 1738965646, 'sys': {'type': 1, 'id': 8372, 'country': 'BR', 'sunrise': 1738919334, 'sunset': 1738965209}, 'timezone': -10800, 'id': 3462377, 'name': 'Goiânia', 'cod': 200} utils_log.py
2025-02-07T18:03:44.978676-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -49.2539, 'lat': -16.6786}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 302.98, 'feels_like': 302.87, 'temp_min': 302.98, 'temp_max': 302.98, 'pressure': 1011, 'humidity': 42, 'sea_level': 1011, 'grnd_level': 924}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 140}, 'clouds': {'all': 20}, 'dt': 1738965646, 'sys': {'type': 1, 'id': 8372, 'country': 'BR', 'sunrise': 1738919334, 'sunset': 1738965209}, 'timezone': -10800, 'id': 3462377, 'name': 'Goiânia', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:44.978676-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:00:46', 'city': 'Goiânia', 'temperature': 29.83, 'feels_like_temp': 29.72, 'humidity': 42, 'wind_speed': 4.12, 'description': 'few clouds', 'longitude': -49.2539, 'latitude': -16.6786} utils_log.py
2025-02-07T18:03:44.978676-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:00:46', 'city': 'Goiânia', 'temperature': 29.83, 'feels_like_temp': 29.72, 'humidity': 42, 'wind_speed': 4.12, 'description': 'few clouds', 'longitude': -49.2539, 'latitude': -16.6786},) e kwargs {} utils_log.py
2025-02-07T18:03:44.978676-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:47.671638-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:00:46', 'city': 'Goiânia', 'temperature': 29.83, 'feels_like_temp': 29.72, 'humidity': 42, 'wind...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:00:46', 'city': 'Goiânia', 'temperature': 29.83, 'feels_like_temp': 29.72, 'humidity': 42, 'win...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:47.673766-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:47.674287-0400 INFO Chamando função 'extract_city_weather_data' com args ('João Pessoa', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:48.107793-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -34.8631, 'lat': -7.115}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 300.28, 'feels_like': 302.59, 'temp_min': 300.28, 'temp_max': 300.28, 'pressure': 1011, 'humidity': 74, 'sea_level': 1011, 'grnd_level': 1006}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 120}, 'clouds': {'all': 20}, 'dt': 1738965713, 'sys': {'type': 1, 'id': 8391, 'country': 'BR', 'sunrise': 1738916543, 'sunset': 1738961093}, 'timezone': -10800, 'id': 3397277, 'name': 'João Pessoa', 'cod': 200} utils_log.py
2025-02-07T18:03:48.107793-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -34.8631, 'lat': -7.115}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 300.28, 'feels_like': 302.59, 'temp_min': 300.28, 'temp_max': 300.28, 'pressure': 1011, 'humidity': 74, 'sea_level': 1011, 'grnd_level': 1006}, 'visibility': 10000, 'wind': {'speed': 4.12, 'deg': 120}, 'clouds': {'all': 20}, 'dt': 1738965713, 'sys': {'type': 1, 'id': 8391, 'country': 'BR', 'sunrise': 1738916543, 'sunset': 1738961093}, 'timezone': -10800, 'id': 3397277, 'name': 'João Pessoa', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:48.107793-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:01:53', 'city': 'João Pessoa', 'temperature': 27.13, 'feels_like_temp': 29.44, 'humidity': 74, 'wind_speed': 4.12, 'description': 'few clouds', 'longitude': -34.8631, 'latitude': -7.115} utils_log.py
2025-02-07T18:03:48.108792-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:01:53', 'city': 'João Pessoa', 'temperature': 27.13, 'feels_like_temp': 29.44, 'humidity': 74, 'wind_speed': 4.12, 'description': 'few clouds', 'longitude': -34.8631, 'latitude': -7.115},) e kwargs {} utils_log.py
2025-02-07T18:03:48.108792-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:50.806442-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:01:53', 'city': 'João Pessoa', 'temperature': 27.13, 'feels_like_temp': 29.44, 'humidity': 74, '...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:01:53', 'city': 'João Pessoa', 'temperature': 27.13, 'feels_like_temp': 29.44, 'humidity': 74, ...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:50.808454-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:50.808454-0400 INFO Chamando função 'extract_city_weather_data' com args ('Macapá', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:51.242562-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -51.0664, 'lat': 0.0389}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 301.14, 'feels_like': 305.69, 'temp_min': 301.14, 'temp_max': 301.14, 'pressure': 1009, 'humidity': 83, 'sea_level': 1009, 'grnd_level': 1008}, 'visibility': 10000, 'wind': {'speed': 5.14, 'deg': 70}, 'clouds': {'all': 40}, 'dt': 1738965831, 'sys': {'type': 1, 'id': 8415, 'country': 'BR', 'sunrise': 1738920903, 'sunset': 1738964511}, 'timezone': -10800, 'id': 3396016, 'name': 'Macapá', 'cod': 200} utils_log.py
2025-02-07T18:03:51.243563-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -51.0664, 'lat': 0.0389}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 301.14, 'feels_like': 305.69, 'temp_min': 301.14, 'temp_max': 301.14, 'pressure': 1009, 'humidity': 83, 'sea_level': 1009, 'grnd_level': 1008}, 'visibility': 10000, 'wind': {'speed': 5.14, 'deg': 70}, 'clouds': {'all': 40}, 'dt': 1738965831, 'sys': {'type': 1, 'id': 8415, 'country': 'BR', 'sunrise': 1738920903, 'sunset': 1738964511}, 'timezone': -10800, 'id': 3396016, 'name': 'Macapá', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:51.243563-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:03:51', 'city': 'Macapá', 'temperature': 27.99, 'feels_like_temp': 32.54, 'humidity': 83, 'wind_speed': 5.14, 'description': 'scattered clouds', 'longitude': -51.0664, 'latitude': 0.0389} utils_log.py
2025-02-07T18:03:51.243563-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:03:51', 'city': 'Macapá', 'temperature': 27.99, 'feels_like_temp': 32.54, 'humidity': 83, 'wind_speed': 5.14, 'description': 'scattered clouds', 'longitude': -51.0664, 'latitude': 0.0389},) e kwargs {} utils_log.py
2025-02-07T18:03:51.243563-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:53.951161-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:03:51', 'city': 'Macapá', 'temperature': 27.99, 'feels_like_temp': 32.54, 'humidity': 83, 'wind_...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:03:51', 'city': 'Macapá', 'temperature': 27.99, 'feels_like_temp': 32.54, 'humidity': 83, 'wind...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:53.953162-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:53.953162-0400 INFO Chamando função 'extract_city_weather_data' com args ('Maceió', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:54.387324-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -35.7353, 'lat': -9.6658}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 299.84, 'feels_like': 302.07, 'temp_min': 299.84, 'temp_max': 299.84, 'pressure': 1011, 'humidity': 78, 'sea_level': 1011, 'grnd_level': 1009}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 100}, 'clouds': {'all': 75}, 'dt': 1738965816, 'sys': {'type': 1, 'id': 8413, 'country': 'BR', 'sunrise': 1738916580, 'sunset': 1738961474}, 'timezone': -10800, 'id': 3395981, 'name': 'Maceió', 'cod': 200} utils_log.py
2025-02-07T18:03:54.387647-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -35.7353, 'lat': -9.6658}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 299.84, 'feels_like': 302.07, 'temp_min': 299.84, 'temp_max': 299.84, 'pressure': 1011, 'humidity': 78, 'sea_level': 1011, 'grnd_level': 1009}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 100}, 'clouds': {'all': 75}, 'dt': 1738965816, 'sys': {'type': 1, 'id': 8413, 'country': 'BR', 'sunrise': 1738916580, 'sunset': 1738961474}, 'timezone': -10800, 'id': 3395981, 'name': 'Maceió', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:54.388153-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:03:36', 'city': 'Maceió', 'temperature': 26.69, 'feels_like_temp': 28.92, 'humidity': 78, 'wind_speed': 2.57, 'description': 'broken clouds', 'longitude': -35.7353, 'latitude': -9.6658} utils_log.py
2025-02-07T18:03:54.388153-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:03:36', 'city': 'Maceió', 'temperature': 26.69, 'feels_like_temp': 28.92, 'humidity': 78, 'wind_speed': 2.57, 'description': 'broken clouds', 'longitude': -35.7353, 'latitude': -9.6658},) e kwargs {} utils_log.py
2025-02-07T18:03:54.388681-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:03:57.091533-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:03:36', 'city': 'Maceió', 'temperature': 26.69, 'feels_like_temp': 28.92, 'humidity': 78, 'wind_...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:03:36', 'city': 'Maceió', 'temperature': 26.69, 'feels_like_temp': 28.92, 'humidity': 78, 'wind...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:03:57.093093-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:03:57.093093-0400 INFO Chamando função 'extract_city_weather_data' com args ('Manaus', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:03:58.536418-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -60.025, 'lat': -3.1019}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'base': 'stations', 'main': {'temp': 298.42, 'feels_like': 299.3, 'temp_min': 298.42, 'temp_max': 298.43, 'pressure': 1006, 'humidity': 88, 'sea_level': 1006, 'grnd_level': 1002}, 'visibility': 10000, 'wind': {'speed': 1.03, 'deg': 0}, 'rain': {'1h': 0.65}, 'clouds': {'all': 75}, 'dt': 1738965603, 'sys': {'type': 1, 'id': 8412, 'country': 'BR', 'sunrise': 1738922848, 'sunset': 1738966866}, 'timezone': -14400, 'id': 3663517, 'name': 'Manaus', 'cod': 200} utils_log.py
2025-02-07T18:03:58.536418-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -60.025, 'lat': -3.1019}, 'weather': [{'id': 500, 'main': 'Rain', 'description': 'light rain', 'icon': '10d'}], 'base': 'stations', 'main': {'temp': 298.42, 'feels_like': 299.3, 'temp_min': 298.42, 'temp_max': 298.43, 'pressure': 1006, 'humidity': 88, 'sea_level': 1006, 'grnd_level': 1002}, 'visibility': 10000, 'wind': {'speed': 1.03, 'deg': 0}, 'rain': {'1h': 0.65}, 'clouds': {'all': 75}, 'dt': 1738965603, 'sys': {'type': 1, 'id': 8412, 'country': 'BR', 'sunrise': 1738922848, 'sunset': 1738966866}, 'timezone': -14400, 'id': 3663517, 'name': 'Manaus', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:03:58.537418-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:00:03', 'city': 'Manaus', 'temperature': 25.27, 'feels_like_temp': 26.15, 'humidity': 88, 'wind_speed': 1.03, 'description': 'light rain', 'longitude': -60.025, 'latitude': -3.1019} utils_log.py
2025-02-07T18:03:58.537418-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:00:03', 'city': 'Manaus', 'temperature': 25.27, 'feels_like_temp': 26.15, 'humidity': 88, 'wind_speed': 1.03, 'description': 'light rain', 'longitude': -60.025, 'latitude': -3.1019},) e kwargs {} utils_log.py
2025-02-07T18:03:58.537418-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:01.239253-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:00:03', 'city': 'Manaus', 'temperature': 25.27, 'feels_like_temp': 26.15, 'humidity': 88, 'wind_...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:00:03', 'city': 'Manaus', 'temperature': 25.27, 'feels_like_temp': 26.15, 'humidity': 88, 'wind...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:01.241252-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:01.241252-0400 INFO Chamando função 'extract_city_weather_data' com args ('Natal', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:01.804728-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -35.2094, 'lat': -5.795}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01n'}], 'base': 'stations', 'main': {'temp': 301.27, 'feels_like': 303.91, 'temp_min': 300.51, 'temp_max': 301.27, 'pressure': 1010, 'humidity': 69, 'sea_level': 1010, 'grnd_level': 1007}, 'visibility': 10000, 'wind': {'speed': 6.17, 'deg': 130}, 'clouds': {'all': 0}, 'dt': 1738965633, 'sys': {'type': 1, 'id': 8417, 'country': 'BR', 'sunrise': 1738916714, 'sunset': 1738961088}, 'timezone': -10800, 'id': 3394023, 'name': 'Natal', 'cod': 200} utils_log.py
2025-02-07T18:04:01.805252-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -35.2094, 'lat': -5.795}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01n'}], 'base': 'stations', 'main': {'temp': 301.27, 'feels_like': 303.91, 'temp_min': 300.51, 'temp_max': 301.27, 'pressure': 1010, 'humidity': 69, 'sea_level': 1010, 'grnd_level': 1007}, 'visibility': 10000, 'wind': {'speed': 6.17, 'deg': 130}, 'clouds': {'all': 0}, 'dt': 1738965633, 'sys': {'type': 1, 'id': 8417, 'country': 'BR', 'sunrise': 1738916714, 'sunset': 1738961088}, 'timezone': -10800, 'id': 3394023, 'name': 'Natal', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:01.805252-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:00:33', 'city': 'Natal', 'temperature': 28.12, 'feels_like_temp': 30.76, 'humidity': 69, 'wind_speed': 6.17, 'description': 'clear sky', 'longitude': -35.2094, 'latitude': -5.795} utils_log.py
2025-02-07T18:04:01.805771-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:00:33', 'city': 'Natal', 'temperature': 28.12, 'feels_like_temp': 30.76, 'humidity': 69, 'wind_speed': 6.17, 'description': 'clear sky', 'longitude': -35.2094, 'latitude': -5.795},) e kwargs {} utils_log.py
2025-02-07T18:04:01.805771-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:04.493421-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:00:33', 'city': 'Natal', 'temperature': 28.12, 'feels_like_temp': 30.76, 'humidity': 69, 'wind_s...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:00:33', 'city': 'Natal', 'temperature': 28.12, 'feels_like_temp': 30.76, 'humidity': 69, 'wind_...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:04.495612-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:04.495612-0400 INFO Chamando função 'extract_city_weather_data' com args ('Palmas', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:05.011958-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -48.3603, 'lat': -10.2128}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 304.08, 'feels_like': 307.37, 'temp_min': 304.08, 'temp_max': 304.08, 'pressure': 1008, 'humidity': 58, 'sea_level': 1008, 'grnd_level': 972}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 190}, 'clouds': {'all': 20}, 'dt': 1738965845, 'sys': {'type': 1, 'id': 8419, 'country': 'BR', 'sunrise': 1738919573, 'sunset': 1738964541}, 'timezone': -10800, 'id': 3474574, 'name': 'Palmas', 'cod': 200} utils_log.py
2025-02-07T18:04:05.012963-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -48.3603, 'lat': -10.2128}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 304.08, 'feels_like': 307.37, 'temp_min': 304.08, 'temp_max': 304.08, 'pressure': 1008, 'humidity': 58, 'sea_level': 1008, 'grnd_level': 972}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 190}, 'clouds': {'all': 20}, 'dt': 1738965845, 'sys': {'type': 1, 'id': 8419, 'country': 'BR', 'sunrise': 1738919573, 'sunset': 1738964541}, 'timezone': -10800, 'id': 3474574, 'name': 'Palmas', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:05.012963-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:04:05', 'city': 'Palmas', 'temperature': 30.93, 'feels_like_temp': 34.22, 'humidity': 58, 'wind_speed': 2.57, 'description': 'few clouds', 'longitude': -48.3603, 'latitude': -10.2128} utils_log.py
2025-02-07T18:04:05.012963-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:04:05', 'city': 'Palmas', 'temperature': 30.93, 'feels_like_temp': 34.22, 'humidity': 58, 'wind_speed': 2.57, 'description': 'few clouds', 'longitude': -48.3603, 'latitude': -10.2128},) e kwargs {} utils_log.py
2025-02-07T18:04:05.012963-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:07.715413-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:04:05', 'city': 'Palmas', 'temperature': 30.93, 'feels_like_temp': 34.22, 'humidity': 58, 'wind_...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:04:05', 'city': 'Palmas', 'temperature': 30.93, 'feels_like_temp': 34.22, 'humidity': 58, 'wind...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:07.717420-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:07.717420-0400 INFO Chamando função 'extract_city_weather_data' com args ('Porto Alegre', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:08.538748-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -51.23, 'lat': -30.0331}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'base': 'stations', 'main': {'temp': 299.84, 'feels_like': 301.43, 'temp_min': 299.81, 'temp_max': 299.97, 'pressure': 1016, 'humidity': 69, 'sea_level': 1016, 'grnd_level': 1013}, 'visibility': 10000, 'wind': {'speed': 7.2, 'deg': 110}, 'clouds': {'all': 40}, 'dt': 1738965664, 'sys': {'type': 2, 'id': 2021802, 'country': 'BR', 'sunrise': 1738918735, 'sunset': 1738966757}, 'timezone': -10800, 'id': 3452925, 'name': 'Porto Alegre', 'cod': 200} utils_log.py
2025-02-07T18:04:08.538748-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -51.23, 'lat': -30.0331}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03d'}], 'base': 'stations', 'main': {'temp': 299.84, 'feels_like': 301.43, 'temp_min': 299.81, 'temp_max': 299.97, 'pressure': 1016, 'humidity': 69, 'sea_level': 1016, 'grnd_level': 1013}, 'visibility': 10000, 'wind': {'speed': 7.2, 'deg': 110}, 'clouds': {'all': 40}, 'dt': 1738965664, 'sys': {'type': 2, 'id': 2021802, 'country': 'BR', 'sunrise': 1738918735, 'sunset': 1738966757}, 'timezone': -10800, 'id': 3452925, 'name': 'Porto Alegre', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:08.538748-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:01:04', 'city': 'Porto Alegre', 'temperature': 26.69, 'feels_like_temp': 28.28, 'humidity': 69, 'wind_speed': 7.2, 'description': 'scattered clouds', 'longitude': -51.23, 'latitude': -30.0331} utils_log.py
2025-02-07T18:04:08.539748-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:01:04', 'city': 'Porto Alegre', 'temperature': 26.69, 'feels_like_temp': 28.28, 'humidity': 69, 'wind_speed': 7.2, 'description': 'scattered clouds', 'longitude': -51.23, 'latitude': -30.0331},) e kwargs {} utils_log.py
2025-02-07T18:04:08.539748-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:11.239247-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:01:04', 'city': 'Porto Alegre', 'temperature': 26.69, 'feels_like_temp': 28.28, 'humidity': 69, ...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:01:04', 'city': 'Porto Alegre', 'temperature': 26.69, 'feels_like_temp': 28.28, 'humidity': 69,...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:11.241248-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:11.241248-0400 INFO Chamando função 'extract_city_weather_data' com args ('Porto Velho', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:11.891317-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -63.9039, 'lat': -8.7619}, 'weather': [{'id': 501, 'main': 'Rain', 'description': 'moderate rain', 'icon': '10d'}], 'base': 'stations', 'main': {'temp': 301.18, 'feels_like': 305.8, 'temp_min': 301.18, 'temp_max': 301.18, 'pressure': 1007, 'humidity': 83, 'sea_level': 1007, 'grnd_level': 997}, 'visibility': 10000, 'wind': {'speed': 1.54, 'deg': 330}, 'rain': {'1h': 1.33}, 'clouds': {'all': 75}, 'dt': 1738965832, 'sys': {'type': 1, 'id': 8424, 'country': 'BR', 'sunrise': 1738923403, 'sunset': 1738968173}, 'timezone': -14400, 'id': 3662762, 'name': 'Porto Velho', 'cod': 200} utils_log.py
2025-02-07T18:04:11.892316-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -63.9039, 'lat': -8.7619}, 'weather': [{'id': 501, 'main': 'Rain', 'description': 'moderate rain', 'icon': '10d'}], 'base': 'stations', 'main': {'temp': 301.18, 'feels_like': 305.8, 'temp_min': 301.18, 'temp_max': 301.18, 'pressure': 1007, 'humidity': 83, 'sea_level': 1007, 'grnd_level': 997}, 'visibility': 10000, 'wind': {'speed': 1.54, 'deg': 330}, 'rain': {'1h': 1.33}, 'clouds': {'all': 75}, 'dt': 1738965832, 'sys': {'type': 1, 'id': 8424, 'country': 'BR', 'sunrise': 1738923403, 'sunset': 1738968173}, 'timezone': -14400, 'id': 3662762, 'name': 'Porto Velho', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:11.892316-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:03:52', 'city': 'Porto Velho', 'temperature': 28.03, 'feels_like_temp': 32.65, 'humidity': 83, 'wind_speed': 1.54, 'description': 'moderate rain', 'longitude': -63.9039, 'latitude': -8.7619} utils_log.py
2025-02-07T18:04:11.892316-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:03:52', 'city': 'Porto Velho', 'temperature': 28.03, 'feels_like_temp': 32.65, 'humidity': 83, 'wind_speed': 1.54, 'description': 'moderate rain', 'longitude': -63.9039, 'latitude': -8.7619},) e kwargs {} utils_log.py
2025-02-07T18:04:11.892316-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:14.600999-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:03:52', 'city': 'Porto Velho', 'temperature': 28.03, 'feels_like_temp': 32.65, 'humidity': 83, '...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:03:52', 'city': 'Porto Velho', 'temperature': 28.03, 'feels_like_temp': 32.65, 'humidity': 83, ...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:14.603000-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:14.603000-0400 INFO Chamando função 'extract_city_weather_data' com args ('Recife', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:15.037661-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -34.8811, 'lat': -8.0539}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 300.17, 'feels_like': 302.38, 'temp_min': 300.17, 'temp_max': 300.17, 'pressure': 1011, 'humidity': 74, 'sea_level': 1011, 'grnd_level': 1008}, 'visibility': 10000, 'wind': {'speed': 4.63, 'deg': 160}, 'clouds': {'all': 40}, 'dt': 1738965627, 'sys': {'type': 1, 'id': 8426, 'country': 'BR', 'sunrise': 1738916484, 'sunset': 1738961160}, 'timezone': -10800, 'id': 3390760, 'name': 'Recife', 'cod': 200} utils_log.py
2025-02-07T18:04:15.038659-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -34.8811, 'lat': -8.0539}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 300.17, 'feels_like': 302.38, 'temp_min': 300.17, 'temp_max': 300.17, 'pressure': 1011, 'humidity': 74, 'sea_level': 1011, 'grnd_level': 1008}, 'visibility': 10000, 'wind': {'speed': 4.63, 'deg': 160}, 'clouds': {'all': 40}, 'dt': 1738965627, 'sys': {'type': 1, 'id': 8426, 'country': 'BR', 'sunrise': 1738916484, 'sunset': 1738961160}, 'timezone': -10800, 'id': 3390760, 'name': 'Recife', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:15.038659-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:00:27', 'city': 'Recife', 'temperature': 27.02, 'feels_like_temp': 29.23, 'humidity': 74, 'wind_speed': 4.63, 'description': 'scattered clouds', 'longitude': -34.8811, 'latitude': -8.0539} utils_log.py
2025-02-07T18:04:15.038659-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:00:27', 'city': 'Recife', 'temperature': 27.02, 'feels_like_temp': 29.23, 'humidity': 74, 'wind_speed': 4.63, 'description': 'scattered clouds', 'longitude': -34.8811, 'latitude': -8.0539},) e kwargs {} utils_log.py
2025-02-07T18:04:15.038659-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:17.727642-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:00:27', 'city': 'Recife', 'temperature': 27.02, 'feels_like_temp': 29.23, 'humidity': 74, 'wind_...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:00:27', 'city': 'Recife', 'temperature': 27.02, 'feels_like_temp': 29.23, 'humidity': 74, 'wind...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:17.729644-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:17.729644-0400 INFO Chamando função 'extract_city_weather_data' com args ('Rio Branco', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:18.177949-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -67.81, 'lat': -9.9747}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 300.49, 'feels_like': 304.01, 'temp_min': 300.49, 'temp_max': 300.49, 'pressure': 1007, 'humidity': 83, 'sea_level': 1007, 'grnd_level': 988}, 'visibility': 10000, 'wind': {'speed': 2.06, 'deg': 340}, 'clouds': {'all': 75}, 'dt': 1738965858, 'sys': {'type': 1, 'id': 8425, 'country': 'BR', 'sunrise': 1738924259, 'sunset': 1738969192}, 'timezone': -18000, 'id': 3662574, 'name': 'Rio Branco', 'cod': 200} utils_log.py
2025-02-07T18:04:18.177949-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -67.81, 'lat': -9.9747}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04d'}], 'base': 'stations', 'main': {'temp': 300.49, 'feels_like': 304.01, 'temp_min': 300.49, 'temp_max': 300.49, 'pressure': 1007, 'humidity': 83, 'sea_level': 1007, 'grnd_level': 988}, 'visibility': 10000, 'wind': {'speed': 2.06, 'deg': 340}, 'clouds': {'all': 75}, 'dt': 1738965858, 'sys': {'type': 1, 'id': 8425, 'country': 'BR', 'sunrise': 1738924259, 'sunset': 1738969192}, 'timezone': -18000, 'id': 3662574, 'name': 'Rio Branco', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:18.178948-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:04:18', 'city': 'Rio Branco', 'temperature': 27.34, 'feels_like_temp': 30.86, 'humidity': 83, 'wind_speed': 2.06, 'description': 'broken clouds', 'longitude': -67.81, 'latitude': -9.9747} utils_log.py
2025-02-07T18:04:18.178948-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:04:18', 'city': 'Rio Branco', 'temperature': 27.34, 'feels_like_temp': 30.86, 'humidity': 83, 'wind_speed': 2.06, 'description': 'broken clouds', 'longitude': -67.81, 'latitude': -9.9747},) e kwargs {} utils_log.py
2025-02-07T18:04:18.178948-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:20.880175-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:04:18', 'city': 'Rio Branco', 'temperature': 27.34, 'feels_like_temp': 30.86, 'humidity': 83, 'w...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:04:18', 'city': 'Rio Branco', 'temperature': 27.34, 'feels_like_temp': 30.86, 'humidity': 83, '...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:20.882177-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:20.882177-0400 INFO Chamando função 'extract_city_weather_data' com args ('Rio de Janeiro', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:21.322313-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -43.2075, 'lat': -22.9028}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 300.91, 'feels_like': 302.67, 'temp_min': 300.13, 'temp_max': 303.27, 'pressure': 1013, 'humidity': 64, 'sea_level': 1013, 'grnd_level': 1014}, 'visibility': 10000, 'wind': {'speed': 6.69, 'deg': 110}, 'clouds': {'all': 20}, 'dt': 1738965855, 'sys': {'type': 1, 'id': 8429, 'country': 'BR', 'sunrise': 1738917412, 'sunset': 1738964229}, 'timezone': -10800, 'id': 3451190, 'name': 'Rio de Janeiro', 'cod': 200} utils_log.py
2025-02-07T18:04:21.322313-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -43.2075, 'lat': -22.9028}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 300.91, 'feels_like': 302.67, 'temp_min': 300.13, 'temp_max': 303.27, 'pressure': 1013, 'humidity': 64, 'sea_level': 1013, 'grnd_level': 1014}, 'visibility': 10000, 'wind': {'speed': 6.69, 'deg': 110}, 'clouds': {'all': 20}, 'dt': 1738965855, 'sys': {'type': 1, 'id': 8429, 'country': 'BR', 'sunrise': 1738917412, 'sunset': 1738964229}, 'timezone': -10800, 'id': 3451190, 'name': 'Rio de Janeiro', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:21.323300-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:04:15', 'city': 'Rio de Janeiro', 'temperature': 27.76, 'feels_like_temp': 29.52, 'humidity': 64, 'wind_speed': 6.69, 'description': 'few clouds', 'longitude': -43.2075, 'latitude': -22.9028} utils_log.py
2025-02-07T18:04:21.323300-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:04:15', 'city': 'Rio de Janeiro', 'temperature': 27.76, 'feels_like_temp': 29.52, 'humidity': 64, 'wind_speed': 6.69, 'description': 'few clouds', 'longitude': -43.2075, 'latitude': -22.9028},) e kwargs {} utils_log.py
2025-02-07T18:04:21.323300-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:24.024347-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:04:15', 'city': 'Rio de Janeiro', 'temperature': 27.76, 'feels_like_temp': 29.52, 'humidity': 64...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:04:15', 'city': 'Rio de Janeiro', 'temperature': 27.76, 'feels_like_temp': 29.52, 'humidity': 6...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:24.026343-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:24.026343-0400 INFO Chamando função 'extract_city_weather_data' com args ('Salvador', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:24.452030-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -88.9167, 'lat': 13.8333}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02d'}], 'base': 'stations', 'main': {'temp': 305.17, 'feels_like': 303.67, 'temp_min': 305.17, 'temp_max': 305.17, 'pressure': 1007, 'humidity': 27, 'sea_level': 1007, 'grnd_level': 949}, 'visibility': 10000, 'wind': {'speed': 2.9, 'deg': 145, 'gust': 4.4}, 'clouds': {'all': 24}, 'dt': 1738965550, 'sys': {'type': 1, 'id': 7219, 'country': 'SV', 'sunrise': 1738930897, 'sunset': 1738972685}, 'timezone': -21600, 'id': 3585968, 'name': 'El Salvador', 'cod': 200} utils_log.py
2025-02-07T18:04:24.452030-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -88.9167, 'lat': 13.8333}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02d'}], 'base': 'stations', 'main': {'temp': 305.17, 'feels_like': 303.67, 'temp_min': 305.17, 'temp_max': 305.17, 'pressure': 1007, 'humidity': 27, 'sea_level': 1007, 'grnd_level': 949}, 'visibility': 10000, 'wind': {'speed': 2.9, 'deg': 145, 'gust': 4.4}, 'clouds': {'all': 24}, 'dt': 1738965550, 'sys': {'type': 1, 'id': 7219, 'country': 'SV', 'sunrise': 1738930897, 'sunset': 1738972685}, 'timezone': -21600, 'id': 3585968, 'name': 'El Salvador', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:24.453031-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 17:59:10', 'city': 'El Salvador', 'temperature': 32.02, 'feels_like_temp': 30.52, 'humidity': 27, 'wind_speed': 2.9, 'description': 'few clouds', 'longitude': -88.9167, 'latitude': 13.8333} utils_log.py
2025-02-07T18:04:24.453031-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 17:59:10', 'city': 'El Salvador', 'temperature': 32.02, 'feels_like_temp': 30.52, 'humidity': 27, 'wind_speed': 2.9, 'description': 'few clouds', 'longitude': -88.9167, 'latitude': 13.8333},) e kwargs {} utils_log.py
2025-02-07T18:04:24.453031-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:27.139604-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 17:59:10', 'city': 'El Salvador', 'temperature': 32.02, 'feels_like_temp': 30.52, 'humidity': 27, '...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 17:59:10', 'city': 'El Salvador', 'temperature': 32.02, 'feels_like_temp': 30.52, 'humidity': 27, ...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:27.141151-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:27.141151-0400 INFO Chamando função 'extract_city_weather_data' com args ('São Luís', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:27.630192-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -44.3028, 'lat': -2.5297}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 300.26, 'feels_like': 304.09, 'temp_min': 300.26, 'temp_max': 300.26, 'pressure': 1009, 'humidity': 89, 'sea_level': 1009, 'grnd_level': 1007}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 40}, 'clouds': {'all': 100}, 'dt': 1738965868, 'sys': {'type': 1, 'id': 8440, 'country': 'BR', 'sunrise': 1738919112, 'sunset': 1738963055}, 'timezone': -10800, 'id': 3388368, 'name': 'São Luís', 'cod': 200} utils_log.py
2025-02-07T18:04:27.630192-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -44.3028, 'lat': -2.5297}, 'weather': [{'id': 804, 'main': 'Clouds', 'description': 'overcast clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 300.26, 'feels_like': 304.09, 'temp_min': 300.26, 'temp_max': 300.26, 'pressure': 1009, 'humidity': 89, 'sea_level': 1009, 'grnd_level': 1007}, 'visibility': 10000, 'wind': {'speed': 2.57, 'deg': 40}, 'clouds': {'all': 100}, 'dt': 1738965868, 'sys': {'type': 1, 'id': 8440, 'country': 'BR', 'sunrise': 1738919112, 'sunset': 1738963055}, 'timezone': -10800, 'id': 3388368, 'name': 'São Luís', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:27.631194-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:04:28', 'city': 'São Luís', 'temperature': 27.11, 'feels_like_temp': 30.94, 'humidity': 89, 'wind_speed': 2.57, 'description': 'overcast clouds', 'longitude': -44.3028, 'latitude': -2.5297} utils_log.py
2025-02-07T18:04:27.631194-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:04:28', 'city': 'São Luís', 'temperature': 27.11, 'feels_like_temp': 30.94, 'humidity': 89, 'wind_speed': 2.57, 'description': 'overcast clouds', 'longitude': -44.3028, 'latitude': -2.5297},) e kwargs {} utils_log.py
2025-02-07T18:04:27.631194-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:30.336249-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:04:28', 'city': 'São Luís', 'temperature': 27.11, 'feels_like_temp': 30.94, 'humidity': 89, 'win...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:04:28', 'city': 'São Luís', 'temperature': 27.11, 'feels_like_temp': 30.94, 'humidity': 89, 'wi...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:30.337789-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:30.337789-0400 INFO Chamando função 'extract_city_weather_data' com args ('São Paulo', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:30.766162-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -46.6361, 'lat': -23.5475}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 298.72, 'feels_like': 299.32, 'temp_min': 297.84, 'temp_max': 300.09, 'pressure': 1015, 'humidity': 76, 'sea_level': 1015, 'grnd_level': 926}, 'visibility': 10000, 'wind': {'speed': 5.14, 'deg': 150}, 'clouds': {'all': 40}, 'dt': 1738965396, 'sys': {'type': 1, 'id': 8394, 'country': 'BR', 'sunrise': 1738918183, 'sunset': 1738965103}, 'timezone': -10800, 'id': 3448439, 'name': 'São Paulo', 'cod': 200} utils_log.py
2025-02-07T18:04:30.766162-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -46.6361, 'lat': -23.5475}, 'weather': [{'id': 802, 'main': 'Clouds', 'description': 'scattered clouds', 'icon': '03n'}], 'base': 'stations', 'main': {'temp': 298.72, 'feels_like': 299.32, 'temp_min': 297.84, 'temp_max': 300.09, 'pressure': 1015, 'humidity': 76, 'sea_level': 1015, 'grnd_level': 926}, 'visibility': 10000, 'wind': {'speed': 5.14, 'deg': 150}, 'clouds': {'all': 40}, 'dt': 1738965396, 'sys': {'type': 1, 'id': 8394, 'country': 'BR', 'sunrise': 1738918183, 'sunset': 1738965103}, 'timezone': -10800, 'id': 3448439, 'name': 'São Paulo', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:30.767162-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 17:56:36', 'city': 'São Paulo', 'temperature': 25.57, 'feels_like_temp': 26.17, 'humidity': 76, 'wind_speed': 5.14, 'description': 'scattered clouds', 'longitude': -46.6361, 'latitude': -23.5475} utils_log.py
2025-02-07T18:04:30.767162-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 17:56:36', 'city': 'São Paulo', 'temperature': 25.57, 'feels_like_temp': 26.17, 'humidity': 76, 'wind_speed': 5.14, 'description': 'scattered clouds', 'longitude': -46.6361, 'latitude': -23.5475},) e kwargs {} utils_log.py
2025-02-07T18:04:30.767162-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:33.456233-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 17:56:36', 'city': 'São Paulo', 'temperature': 25.57, 'feels_like_temp': 26.17, 'humidity': 76, 'wi...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 17:56:36', 'city': 'São Paulo', 'temperature': 25.57, 'feels_like_temp': 26.17, 'humidity': 76, 'w...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:33.458234-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:33.458234-0400 INFO Chamando função 'extract_city_weather_data' com args ('Teresina', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:33.901516-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -42.8019, 'lat': -5.0892}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 297.99, 'feels_like': 299.14, 'temp_min': 297.99, 'temp_max': 297.99, 'pressure': 1008, 'humidity': 100, 'sea_level': 1008, 'grnd_level': 996}, 'visibility': 10000, 'wind': {'speed': 0, 'deg': 0}, 'clouds': {'all': 75}, 'dt': 1738965752, 'sys': {'type': 1, 'id': 8447, 'country': 'BR', 'sunrise': 1738918583, 'sunset': 1738962864}, 'timezone': -10800, 'id': 3386496, 'name': 'Teresina', 'cod': 200} utils_log.py
2025-02-07T18:04:33.902046-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -42.8019, 'lat': -5.0892}, 'weather': [{'id': 803, 'main': 'Clouds', 'description': 'broken clouds', 'icon': '04n'}], 'base': 'stations', 'main': {'temp': 297.99, 'feels_like': 299.14, 'temp_min': 297.99, 'temp_max': 297.99, 'pressure': 1008, 'humidity': 100, 'sea_level': 1008, 'grnd_level': 996}, 'visibility': 10000, 'wind': {'speed': 0, 'deg': 0}, 'clouds': {'all': 75}, 'dt': 1738965752, 'sys': {'type': 1, 'id': 8447, 'country': 'BR', 'sunrise': 1738918583, 'sunset': 1738962864}, 'timezone': -10800, 'id': 3386496, 'name': 'Teresina', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:33.902574-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:02:32', 'city': 'Teresina', 'temperature': 24.84, 'feels_like_temp': 25.99, 'humidity': 100, 'wind_speed': 0, 'description': 'broken clouds', 'longitude': -42.8019, 'latitude': -5.0892} utils_log.py
2025-02-07T18:04:33.902574-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:02:32', 'city': 'Teresina', 'temperature': 24.84, 'feels_like_temp': 25.99, 'humidity': 100, 'wind_speed': 0, 'description': 'broken clouds', 'longitude': -42.8019, 'latitude': -5.0892},) e kwargs {} utils_log.py
2025-02-07T18:04:33.902574-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:36.599417-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:02:32', 'city': 'Teresina', 'temperature': 24.84, 'feels_like_temp': 25.99, 'humidity': 100, 'wi...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:02:32', 'city': 'Teresina', 'temperature': 24.84, 'feels_like_temp': 25.99, 'humidity': 100, 'w...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:36.601403-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
2025-02-07T18:04:36.601403-0400 INFO Chamando função 'extract_city_weather_data' com args ('Vitória', 'bc531a3264637b5d6b6b8720d26cd3e0') e kwargs {} utils_log.py
2025-02-07T18:04:37.256524-0400 INFO Função 'extract_city_weather_data' retornou {'coord': {'lon': -40.3378, 'lat': -20.3194}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 300.07, 'feels_like': 302.54, 'temp_min': 300.07, 'temp_max': 300.07, 'pressure': 1014, 'humidity': 78, 'sea_level': 1014, 'grnd_level': 1009}, 'visibility': 10000, 'wind': {'speed': 3.6, 'deg': 20}, 'clouds': {'all': 20}, 'dt': 1738965877, 'sys': {'type': 1, 'id': 8474, 'country': 'BR', 'sunrise': 1738916923, 'sunset': 1738963340}, 'timezone': -10800, 'id': 3444924, 'name': 'Vitória', 'cod': 200} utils_log.py
2025-02-07T18:04:37.257541-0400 INFO Chamando função 'transform_city_weather_data' com args ({'coord': {'lon': -40.3378, 'lat': -20.3194}, 'weather': [{'id': 801, 'main': 'Clouds', 'description': 'few clouds', 'icon': '02n'}], 'base': 'stations', 'main': {'temp': 300.07, 'feels_like': 302.54, 'temp_min': 300.07, 'temp_max': 300.07, 'pressure': 1014, 'humidity': 78, 'sea_level': 1014, 'grnd_level': 1009}, 'visibility': 10000, 'wind': {'speed': 3.6, 'deg': 20}, 'clouds': {'all': 20}, 'dt': 1738965877, 'sys': {'type': 1, 'id': 8474, 'country': 'BR', 'sunrise': 1738916923, 'sunset': 1738963340}, 'timezone': -10800, 'id': 3444924, 'name': 'Vitória', 'cod': 200},) e kwargs {} utils_log.py
2025-02-07T18:04:37.257541-0400 INFO Função 'transform_city_weather_data' retornou {'timestamp': '2025-02-07 18:04:37', 'city': 'Vitória', 'temperature': 26.92, 'feels_like_temp': 29.39, 'humidity': 78, 'wind_speed': 3.6, 'description': 'few clouds', 'longitude': -40.3378, 'latitude': -20.3194} utils_log.py
2025-02-07T18:04:37.257541-0400 INFO Chamando função 'load_weather_data_on_database' com args ({'timestamp': '2025-02-07 18:04:37', 'city': 'Vitória', 'temperature': 26.92, 'feels_like_temp': 29.39, 'humidity': 78, 'wind_speed': 3.6, 'description': 'few clouds', 'longitude': -40.3378, 'latitude': -20.3194},) e kwargs {} utils_log.py
2025-02-07T18:04:37.257541-0400 INFO Chamando função 'database_connection' com args () e kwargs {} utils_log.py
2025-02-07T18:04:39.952097-0400 ERROR Exceção capturada em 'database_connection': 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte utils_log.py
Traceback (most recent call last):

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 151, in <module>
    load_weather_data_on_database(transformed_data)
    │                             └ {'timestamp': '2025-02-07 18:04:37', 'city': 'Vitória', 'temperature': 26.92, 'feels_like_temp': 29.39, 'humidity': 78, 'wind...
    └ <function load_weather_data_on_database at 0x000001DFF1528400>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ({'timestamp': '2025-02-07 18:04:37', 'city': 'Vitória', 'temperature': 26.92, 'feels_like_temp': 29.39, 'humidity': 78, 'win...
             └ <function load_weather_data_on_database at 0x000001DFF1528360>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 118, in load_weather_data_on_database
    conn = database_connection()
           └ <function database_connection at 0x000001DFF1528180>

> File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\utils_log.py", line 27, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ()
             └ <function database_connection at 0x000001DFF15280E0>

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\src\pipeline.py", line 76, in database_connection
    return psycopg2.connect(
           │        └ <function connect at 0x000001DFF0A5E2A0>
           └ <module 'psycopg2' from 'C:\\Users\\pschm\\OneDrive\\eng\\projetos\\weather_data_ETL_pipeline\\.venv\\Lib\\site-packages\\psy...

  File "C:\Users\pschm\OneDrive\eng\projetos\weather_data_ETL_pipeline\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           │        │                       │                     └ {}
           │        │                       └ None
           │        └ 'host=postgres user=weather_user password=weatherpass dbname=weather_db'
           └ <built-in function _connect>

UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 64: invalid continuation byte
2025-02-07T18:04:39.953653-0400 INFO Função 'load_weather_data_on_database' retornou None utils_log.py
